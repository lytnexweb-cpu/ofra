<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Maquette 13 — Gestion des parties</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwindcss.config = {
      theme: {
        extend: {
          colors: { primary: '#1e3a5f', accent: '#e07a2f' },
          fontFamily: { outfit: ['Outfit', 'system-ui', 'sans-serif'] },
        },
      },
    }
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    .viewport-btn.active { background: #1e3a5f; color: white; }
    .viewport-frame { transition: width 0.4s ease, max-width 0.4s ease; margin: 0 auto; overflow: hidden; }
    .overlay { background: rgba(0,0,0,0.5); backdrop-filter: blur(2px); overflow-y: auto; }
    .modal-enter {
      animation: modalIn 0.2s ease-out;
      display: flex;
      flex-direction: column;
      max-height: calc(100% - 6rem);
    }
    .modal-body {
      overflow-y: auto;
      flex: 1;
      min-height: 0;
    }
    @keyframes modalIn { from { opacity: 0; transform: scale(0.95) translateY(8px); } to { opacity: 1; transform: scale(1) translateY(0); } }

    /* Mobile bottom-sheet */
    .mobile-mode { overflow-y: auto !important; }
    .mobile-mode .overlay {
      align-items: flex-end;
      padding: 0;
      overflow-y: auto;
    }
    .mobile-mode .modal-enter {
      max-width: 100%;
      border-radius: 1rem 1rem 0 0;
      max-height: 92%;
      display: flex;
      flex-direction: column;
      animation: sheetUp 0.25s ease-out;
    }
    .mobile-mode .modal-body {
      overflow-y: auto;
      flex: 1;
      min-height: 0;
    }
    .mobile-mode .mobile-handle { display: flex; }
    .mobile-mode .modal-header { padding-top: 0.75rem; }
    @keyframes sheetUp { from { opacity: 0; transform: translateY(100%); } to { opacity: 1; transform: translateY(0); } }

    /* Party card hover */
    .party-card { transition: box-shadow 0.15s ease, border-color 0.15s ease; }
    .party-card:hover { box-shadow: 0 1px 4px rgba(0,0,0,0.08); border-color: #d6d3d1; }

    /* Add form animation */
    .add-form-enter { animation: formSlide 0.2s ease-out; }
    @keyframes formSlide { from { opacity: 0; max-height: 0; } to { opacity: 1; max-height: 400px; } }
  </style>
</head>
<body class="bg-stone-200 min-h-screen">

  <!-- VIEWPORT SWITCHER -->
  <div class="fixed top-0 left-0 right-0 bg-stone-800 text-white z-[100] shadow-lg">
    <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <span class="text-sm font-bold font-outfit">MAQUETTE 13</span>
        <span class="text-xs text-stone-400">Gestion des parties — Modale centrée</span>
      </div>
      <div class="flex items-center gap-2">
        <button onclick="setViewport('mobile')" id="btn-mobile" class="viewport-btn px-3 py-1.5 rounded-lg text-xs font-medium bg-stone-700 hover:bg-stone-600 transition-colors">Mobile (375px)</button>
        <button onclick="setViewport('tablet')" id="btn-tablet" class="viewport-btn px-3 py-1.5 rounded-lg text-xs font-medium bg-stone-700 hover:bg-stone-600 transition-colors">Tablette (768px)</button>
        <button onclick="setViewport('desktop')" id="btn-desktop" class="viewport-btn active px-3 py-1.5 rounded-lg text-xs font-medium bg-stone-700 hover:bg-stone-600 transition-colors">Desktop (1280px)</button>
      </div>
      <div class="text-xs text-stone-400">Accessible via : bouton "Parties" dans le header transaction</div>
    </div>
  </div>

  <!-- VIEWPORT FRAME -->
  <div class="pt-16 pb-8 px-4">
    <div id="viewport-frame" class="viewport-frame bg-stone-100 shadow-2xl rounded-xl overflow-hidden border border-stone-300 relative" style="width: 100%; max-width: 1280px; height: 85vh;">

      <!-- Fond simulé (page transaction floutée) -->
      <div class="absolute inset-0 flex items-center justify-center p-4 sm:p-8">
        <div class="w-full max-w-4xl opacity-30">
          <div class="h-8 bg-stone-300 rounded mb-4 w-48"></div>
          <div class="h-4 bg-stone-200 rounded mb-2 w-64"></div>
          <div class="h-32 bg-stone-200 rounded mb-4"></div>
          <div class="h-48 bg-stone-200 rounded mb-4"></div>
          <div class="h-64 bg-stone-200 rounded"></div>
        </div>
      </div>

      <!-- OVERLAY -->
      <div class="overlay absolute inset-0 z-40 flex items-center justify-center p-4">

        <!-- ============================================== -->
        <!-- ÉTAT A : LISTE DES PARTIES (état par défaut)   -->
        <!-- ============================================== -->
        <div id="state-list" class="modal-enter bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden">

          <!-- Drag handle (mobile bottom-sheet) -->
          <div class="mobile-handle hidden justify-center pt-2 pb-1">
            <div class="w-10 h-1 rounded-full bg-stone-300"></div>
          </div>

          <!-- Header modale -->
          <div class="modal-header px-5 sm:px-6 pt-5 sm:pt-6 pb-4 border-b border-stone-100">
            <div class="flex items-start justify-between">
              <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center shrink-0">
                  <svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/></svg>
                </div>
                <div>
                  <h2 class="text-base sm:text-lg font-bold text-stone-900 font-outfit">Parties de la transaction</h2>
                  <p class="text-xs text-stone-500 mt-0.5">Gérez les intervenants, leurs rôles et coordonnées</p>
                </div>
              </div>
              <button class="p-1.5 rounded-lg hover:bg-stone-100 text-stone-400 -mt-1 -mr-1">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
              </button>
            </div>
          </div>

          <!-- Corps modale — Liste des parties -->
          <div class="modal-body px-5 sm:px-6 py-4 space-y-3">

            <!-- Partie 1 : Acheteur (principal, email OK) -->
            <div class="party-card rounded-lg border border-stone-200 bg-white p-3 relative group">
              <div class="flex items-start gap-3">
                <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center shrink-0 mt-0.5">
                  <span class="text-xs font-bold text-blue-700">JT</span>
                </div>
                <div class="flex-1 min-w-0">
                  <div class="flex items-center gap-2">
                    <span class="text-sm font-semibold text-stone-900">Jean Tremblay</span>
                    <span class="inline-flex items-center px-1.5 py-0.5 rounded-full text-[10px] font-semibold bg-blue-100 text-blue-700">Acheteur</span>
                    <span class="inline-flex items-center px-1.5 py-0.5 rounded-full text-[10px] font-medium bg-primary/10 text-primary">Principal</span>
                  </div>
                  <div class="flex items-center gap-3 mt-1.5">
                    <div class="flex items-center gap-1">
                      <div class="w-1.5 h-1.5 rounded-full bg-emerald-400"></div>
                      <span class="text-xs text-stone-600">jean.tremblay@email.com</span>
                    </div>
                  </div>
                  <div class="flex items-center gap-1 mt-0.5">
                    <svg class="w-3 h-3 text-stone-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/></svg>
                    <span class="text-xs text-stone-500">514-555-1234</span>
                  </div>
                </div>
                <!-- Actions (visible on hover / always on mobile) -->
                <div class="flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity sm:opacity-0 sm:group-hover:opacity-100">
                  <button onclick="showEdit()" class="p-1.5 rounded-lg hover:bg-stone-100 text-stone-400 hover:text-stone-600">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/></svg>
                  </button>
                  <button class="p-1.5 rounded-lg hover:bg-red-50 text-stone-400 hover:text-red-500">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>
                  </button>
                </div>
              </div>
            </div>

            <!-- Partie 2 : Vendeur (email OK) -->
            <div class="party-card rounded-lg border border-stone-200 bg-white p-3 relative group">
              <div class="flex items-start gap-3">
                <div class="w-8 h-8 rounded-full bg-emerald-100 flex items-center justify-center shrink-0 mt-0.5">
                  <span class="text-xs font-bold text-emerald-700">MD</span>
                </div>
                <div class="flex-1 min-w-0">
                  <div class="flex items-center gap-2">
                    <span class="text-sm font-semibold text-stone-900">Marie Dupont</span>
                    <span class="inline-flex items-center px-1.5 py-0.5 rounded-full text-[10px] font-semibold bg-emerald-100 text-emerald-700">Vendeur</span>
                  </div>
                  <div class="flex items-center gap-3 mt-1.5">
                    <div class="flex items-center gap-1">
                      <div class="w-1.5 h-1.5 rounded-full bg-emerald-400"></div>
                      <span class="text-xs text-stone-600">m.dupont@email.com</span>
                    </div>
                  </div>
                  <div class="flex items-center gap-1 mt-0.5">
                    <svg class="w-3 h-3 text-stone-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/></svg>
                    <span class="text-xs text-stone-500">514-555-5678</span>
                  </div>
                </div>
                <div class="flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
                  <button onclick="showEdit()" class="p-1.5 rounded-lg hover:bg-stone-100 text-stone-400 hover:text-stone-600">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/></svg>
                  </button>
                  <button class="p-1.5 rounded-lg hover:bg-red-50 text-stone-400 hover:text-red-500">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>
                  </button>
                </div>
              </div>
            </div>

            <!-- Partie 3 : Avocat (email MANQUANT — warning) -->
            <div class="party-card rounded-lg border border-amber-200 bg-amber-50/30 p-3 relative group">
              <div class="flex items-start gap-3">
                <div class="w-8 h-8 rounded-full bg-amber-100 flex items-center justify-center shrink-0 mt-0.5">
                  <span class="text-xs font-bold text-amber-700">RG</span>
                </div>
                <div class="flex-1 min-w-0">
                  <div class="flex items-center gap-2">
                    <span class="text-sm font-semibold text-stone-900">Me Robert Gagnon</span>
                    <span class="inline-flex items-center px-1.5 py-0.5 rounded-full text-[10px] font-semibold bg-stone-100 text-stone-600">Avocat</span>
                  </div>
                  <div class="flex items-center gap-3 mt-1.5">
                    <div class="flex items-center gap-1">
                      <div class="w-1.5 h-1.5 rounded-full bg-amber-400"></div>
                      <span class="text-xs text-amber-600 italic">Email manquant</span>
                    </div>
                  </div>
                  <div class="flex items-center gap-1 mt-1">
                    <svg class="w-3 h-3 text-amber-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"/></svg>
                    <span class="text-[10px] text-amber-600 font-medium">Ne recevra pas les notifications — ajouter un email</span>
                  </div>
                </div>
                <div class="flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
                  <button onclick="showEdit()" class="p-1.5 rounded-lg hover:bg-stone-100 text-stone-400 hover:text-stone-600">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/></svg>
                  </button>
                  <button class="p-1.5 rounded-lg hover:bg-red-50 text-stone-400 hover:text-red-500">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>
                  </button>
                </div>
              </div>
            </div>

            <!-- Bouton Ajouter une partie -->
            <button id="btn-add-party" onclick="toggleAddForm()" class="w-full flex items-center justify-center gap-2 py-3 rounded-lg border-2 border-dashed border-stone-200 text-stone-400 hover:border-primary/30 hover:text-primary hover:bg-primary/5 transition-colors">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/></svg>
              <span class="text-xs font-medium">Ajouter une partie</span>
            </button>

            <!-- ══════════════════════════════════════════ -->
            <!-- Formulaire d'ajout (masqué par défaut)     -->
            <!-- ══════════════════════════════════════════ -->
            <div id="add-form" class="hidden add-form-enter rounded-lg border border-primary/20 bg-primary/[0.02] p-4 space-y-3">
              <div class="flex items-center justify-between mb-1">
                <h3 class="text-xs font-semibold text-stone-700 uppercase tracking-wide">Ajouter une partie</h3>
                <button onclick="toggleAddForm()" class="p-1 rounded hover:bg-stone-100 text-stone-400">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                </button>
              </div>

              <!-- Rôle -->
              <div>
                <label class="block text-xs font-semibold text-stone-600 mb-1 uppercase tracking-wide">
                  Rôle <span class="text-red-400">*</span>
                </label>
                <select id="role-select" class="w-full px-3 py-2.5 text-sm rounded-lg border border-stone-200 focus:outline-none focus:ring-2 focus:ring-primary/20 bg-white">
                  <option value="">Sélectionner un rôle...</option>
                  <option value="buyer">Acheteur</option>
                  <option value="seller">Vendeur</option>
                  <option value="lawyer">Avocat</option>
                  <option value="notary">Notaire</option>
                  <option value="broker">Courtier</option>
                  <option value="agent">Agent</option>
                  <option value="other">Autre</option>
                </select>
              </div>

              <!-- Nom complet -->
              <div>
                <label class="block text-xs font-semibold text-stone-600 mb-1 uppercase tracking-wide">
                  Nom complet <span class="text-red-400">*</span>
                </label>
                <input type="text" placeholder="Me Pierre Lavigne" class="w-full px-3 py-2.5 text-sm rounded-lg border border-stone-200 focus:outline-none focus:ring-2 focus:ring-primary/20">
              </div>

              <!-- Email + Téléphone côte à côte -->
              <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                <div>
                  <label class="block text-xs font-semibold text-stone-600 mb-1 uppercase tracking-wide">Email</label>
                  <input type="email" placeholder="email@exemple.com" class="w-full px-3 py-2.5 text-sm rounded-lg border border-stone-200 focus:outline-none focus:ring-2 focus:ring-primary/20">
                </div>
                <div>
                  <label class="block text-xs font-semibold text-stone-600 mb-1 uppercase tracking-wide">Téléphone</label>
                  <input type="tel" placeholder="514-555-0000" class="w-full px-3 py-2.5 text-sm rounded-lg border border-stone-200 focus:outline-none focus:ring-2 focus:ring-primary/20">
                </div>
              </div>

              <!-- Partie principale checkbox -->
              <label class="flex items-start gap-2.5 cursor-pointer mt-1">
                <input type="checkbox" class="mt-0.5 w-4 h-4 rounded border-stone-300 accent-primary">
                <div>
                  <span class="text-xs font-medium text-stone-700">Partie principale</span>
                  <p class="text-[10px] text-stone-400 mt-0.5">Recevra toutes les notifications liées à cette transaction</p>
                </div>
              </label>

              <!-- Boutons formulaire -->
              <div class="flex items-center gap-2 pt-2 border-t border-stone-100">
                <button onclick="toggleAddForm()" class="px-4 py-2 rounded-lg border border-stone-200 text-stone-600 hover:bg-stone-100 text-xs font-medium">
                  Annuler
                </button>
                <button class="px-4 py-2 rounded-lg bg-primary hover:bg-primary/90 text-white text-xs font-semibold shadow-sm flex items-center gap-1.5">
                  <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                  Ajouter
                </button>
              </div>
            </div>

          </div>

          <!-- Info footer -->
          <div class="px-5 sm:px-6 py-3 bg-stone-50 border-t border-stone-100">
            <div class="flex items-start gap-2">
              <svg class="w-4 h-4 text-stone-400 shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
              <div>
                <p class="text-[10px] text-stone-500">Les parties avec un email valide recevront automatiquement les notifications lors des offres, changements de statut et événements importants de la transaction.</p>
                <div class="flex items-center gap-3 mt-1.5">
                  <div class="flex items-center gap-1">
                    <div class="w-1.5 h-1.5 rounded-full bg-emerald-400"></div>
                    <span class="text-[10px] text-stone-400">Email renseigné</span>
                  </div>
                  <div class="flex items-center gap-1">
                    <div class="w-1.5 h-1.5 rounded-full bg-amber-400"></div>
                    <span class="text-[10px] text-stone-400">Email manquant</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Footer modale -->
          <div class="px-5 sm:px-6 py-4 bg-white border-t border-stone-100 flex flex-col-reverse sm:flex-row items-stretch sm:items-center gap-2 sm:justify-between">
            <div class="text-xs text-stone-400 flex items-center gap-1.5">
              <span class="font-semibold text-stone-600">3</span> parties
              <span class="text-stone-300 mx-1">|</span>
              <div class="flex items-center gap-1">
                <div class="w-1.5 h-1.5 rounded-full bg-emerald-400"></div>
                <span>2 notifiables</span>
              </div>
              <span class="text-stone-300 mx-1">|</span>
              <div class="flex items-center gap-1">
                <div class="w-1.5 h-1.5 rounded-full bg-amber-400"></div>
                <span>1 email manquant</span>
              </div>
            </div>
            <button class="px-4 py-2.5 rounded-lg border border-stone-200 text-stone-600 hover:bg-stone-100 text-sm font-medium text-center">
              Fermer
            </button>
          </div>

        </div>
      </div>

    </div>
  </div>

  <!-- ============================================== -->
  <!-- ÉTAT B : FORMULAIRE D'ÉDITION (sous l'overlay) -->
  <!-- ============================================== -->
  <div class="px-4 mb-8">
    <div class="max-w-lg mx-auto">
      <div class="flex items-center gap-2 mb-3">
        <div class="w-2 h-2 rounded-full bg-stone-400"></div>
        <span class="text-xs text-stone-500 font-medium uppercase tracking-wide">État B — Édition d'une partie</span>
        <div class="flex-1 h-px bg-stone-300"></div>
      </div>

      <div class="bg-white rounded-2xl shadow-lg border border-stone-200 overflow-hidden">
        <!-- Header -->
        <div class="px-5 sm:px-6 pt-5 sm:pt-6 pb-4 border-b border-stone-100">
          <div class="flex items-start justify-between">
            <div class="flex items-center gap-3">
              <button class="p-1.5 rounded-lg hover:bg-stone-100 text-stone-400">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
              </button>
              <div>
                <h2 class="text-base sm:text-lg font-bold text-stone-900 font-outfit">Modifier la partie</h2>
                <p class="text-xs text-stone-500 mt-0.5">Me Robert Gagnon — Avocat</p>
              </div>
            </div>
            <button class="p-1.5 rounded-lg hover:bg-stone-100 text-stone-400 -mt-1 -mr-1">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
            </button>
          </div>
        </div>

        <!-- Corps édition -->
        <div class="px-5 sm:px-6 py-4 space-y-3">
          <!-- Rôle -->
          <div>
            <label class="block text-xs font-semibold text-stone-600 mb-1 uppercase tracking-wide">
              Rôle <span class="text-red-400">*</span>
            </label>
            <select class="w-full px-3 py-2.5 text-sm rounded-lg border border-stone-200 focus:outline-none focus:ring-2 focus:ring-primary/20 bg-white">
              <option value="lawyer" selected>Avocat</option>
              <option value="buyer">Acheteur</option>
              <option value="seller">Vendeur</option>
              <option value="notary">Notaire</option>
              <option value="broker">Courtier</option>
              <option value="agent">Agent</option>
              <option value="other">Autre</option>
            </select>
          </div>

          <!-- Nom complet -->
          <div>
            <label class="block text-xs font-semibold text-stone-600 mb-1 uppercase tracking-wide">
              Nom complet <span class="text-red-400">*</span>
            </label>
            <input type="text" value="Me Robert Gagnon" class="w-full px-3 py-2.5 text-sm rounded-lg border border-stone-200 focus:outline-none focus:ring-2 focus:ring-primary/20">
          </div>

          <!-- Email (highlighted — manquant) -->
          <div>
            <label class="block text-xs font-semibold text-stone-600 mb-1 uppercase tracking-wide flex items-center gap-1.5">
              Email
              <span class="inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium bg-amber-100 text-amber-700">Manquant</span>
            </label>
            <input type="email" placeholder="robert.gagnon@cabinet.com" class="w-full px-3 py-2.5 text-sm rounded-lg border border-amber-300 bg-amber-50/30 focus:outline-none focus:ring-2 focus:ring-amber-200 placeholder:text-amber-400/60">
            <p class="text-[10px] text-amber-600 mt-1 flex items-center gap-1">
              <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"/></svg>
              Sans email, cette partie ne recevra pas les notifications
            </p>
          </div>

          <!-- Téléphone -->
          <div>
            <label class="block text-xs font-semibold text-stone-600 mb-1 uppercase tracking-wide">Téléphone</label>
            <input type="tel" placeholder="514-555-0000" class="w-full px-3 py-2.5 text-sm rounded-lg border border-stone-200 focus:outline-none focus:ring-2 focus:ring-primary/20">
          </div>

          <!-- Partie principale -->
          <label class="flex items-start gap-2.5 cursor-pointer mt-1">
            <input type="checkbox" class="mt-0.5 w-4 h-4 rounded border-stone-300 accent-primary">
            <div>
              <span class="text-xs font-medium text-stone-700">Partie principale</span>
              <p class="text-[10px] text-stone-400 mt-0.5">Recevra toutes les notifications liées à cette transaction</p>
            </div>
          </label>
        </div>

        <!-- Footer édition -->
        <div class="px-5 sm:px-6 py-4 bg-stone-50 border-t border-stone-100 flex flex-col-reverse sm:flex-row items-stretch sm:items-center gap-2 sm:justify-between">
          <button class="px-4 py-2.5 rounded-lg text-red-500 hover:bg-red-50 text-sm font-medium text-center flex items-center justify-center gap-1.5">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>
            Supprimer cette partie
          </button>
          <div class="flex items-center gap-2">
            <button class="px-4 py-2.5 rounded-lg border border-stone-200 text-stone-600 hover:bg-stone-100 text-sm font-medium">
              Annuler
            </button>
            <button class="px-5 py-2.5 rounded-lg bg-primary hover:bg-primary/90 text-white text-sm font-semibold shadow-sm flex items-center gap-2">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
              Enregistrer
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ============================================== -->
  <!-- ÉTAT C : CONFIRMATION SUPPRESSION               -->
  <!-- ============================================== -->
  <div class="px-4 mb-8">
    <div class="max-w-sm mx-auto">
      <div class="flex items-center gap-2 mb-3">
        <div class="w-2 h-2 rounded-full bg-red-400"></div>
        <span class="text-xs text-stone-500 font-medium uppercase tracking-wide">État C — Confirmation de suppression</span>
        <div class="flex-1 h-px bg-stone-300"></div>
      </div>

      <div class="bg-white rounded-2xl shadow-lg border border-stone-200 overflow-hidden">
        <div class="px-5 sm:px-6 py-5 text-center">
          <div class="w-12 h-12 rounded-full bg-red-100 flex items-center justify-center mx-auto mb-3">
            <svg class="w-6 h-6 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"/></svg>
          </div>
          <h2 class="text-base font-bold text-stone-900 font-outfit">Supprimer cette partie ?</h2>
          <p class="text-sm text-stone-500 mt-1">Me Robert Gagnon (Avocat) sera retiré de la transaction.</p>
          <p class="text-xs text-stone-400 mt-2">Cette personne ne recevra plus aucune notification.</p>
        </div>
        <div class="px-5 sm:px-6 py-4 bg-stone-50 border-t border-stone-100 flex items-center gap-2 justify-center">
          <button class="px-4 py-2.5 rounded-lg border border-stone-200 text-stone-600 hover:bg-stone-100 text-sm font-medium">
            Annuler
          </button>
          <button class="px-5 py-2.5 rounded-lg bg-red-500 hover:bg-red-600 text-white text-sm font-semibold shadow-sm flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>
            Supprimer
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- VIEWPORT SCRIPT -->
  <script>
    function toggleAddForm() {
      const form = document.getElementById('add-form');
      const btn = document.getElementById('btn-add-party');
      if (form.classList.contains('hidden')) {
        form.classList.remove('hidden');
        btn.classList.add('hidden');
      } else {
        form.classList.add('hidden');
        btn.classList.remove('hidden');
      }
    }

    function showEdit() {
      // Scroll to edit state for demo
      document.querySelector('[class*="État B"]')?.parentElement?.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function setViewport(mode) {
      const frame = document.getElementById('viewport-frame');
      document.querySelectorAll('.viewport-btn').forEach(b => b.classList.remove('active'));
      document.getElementById('btn-' + mode).classList.add('active');
      if (mode === 'mobile') { frame.style.maxWidth = '375px'; frame.classList.add('mobile-mode'); }
      else if (mode === 'tablet') { frame.style.maxWidth = '768px'; frame.classList.remove('mobile-mode'); }
      else { frame.style.maxWidth = '1280px'; frame.classList.remove('mobile-mode'); }
    }
  </script>

</body>
</html>
