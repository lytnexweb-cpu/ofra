<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Maquette 10 — Exporter & Partager</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwindcss.config = {
      theme: {
        extend: {
          colors: { primary: '#1e3a5f', accent: '#e07a2f' },
          fontFamily: { outfit: ['Outfit', 'system-ui', 'sans-serif'] },
        },
      },
    }
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    .viewport-btn.active { background: #1e3a5f; color: white; }
    .viewport-frame { transition: width 0.4s ease, max-width 0.4s ease; margin: 0 auto; overflow: hidden; }
    .overlay { background: rgba(0,0,0,0.5); backdrop-filter: blur(2px); overflow-y: auto; }
    .modal-enter {
      animation: modalIn 0.2s ease-out;
      display: flex; flex-direction: column; max-height: calc(100% - 2rem);
    }
    .modal-body { overflow-y: auto; flex: 1; min-height: 0; }
    @keyframes modalIn { from { opacity:0; transform: scale(0.95) translateY(8px); } to { opacity:1; transform: scale(1) translateY(0); } }
    .mobile-mode { overflow-y: auto !important; }
    .mobile-mode .overlay { align-items: flex-end; padding: 0; }
    .mobile-mode .modal-enter { max-width:100%; border-radius:1rem 1rem 0 0; max-height:92%; animation: sheetUp 0.25s ease-out; }
    .mobile-mode .mobile-handle { display: flex; }
    .mobile-mode .modal-header { padding-top: 0.75rem; }
    @keyframes sheetUp { from { opacity:0; transform: translateY(100%); } to { opacity:1; transform: translateY(0); } }
    .state-section { display: none; }
    .state-section.active { display: block; }
    .state-btn.active { background: #1e3a5f; color: white; }
    .viewport-frame-scrollable { overflow-y: auto !important; }

    /* Toggle switch */
    .toggle-track { width: 36px; height: 20px; border-radius: 10px; background: #d6d3d1; transition: background 0.2s; position: relative; cursor: pointer; }
    .toggle-track.on { background: #1e3a5f; }
    .toggle-dot { width: 16px; height: 16px; border-radius: 50%; background: white; position: absolute; top: 2px; left: 2px; transition: transform 0.2s; box-shadow: 0 1px 3px rgba(0,0,0,0.15); }
    .toggle-track.on .toggle-dot { transform: translateX(16px); }

    /* Progress bar */
    .progress-fill { transition: width 0.6s ease; }
    @keyframes pulse { 0%,100% { opacity:1; } 50% { opacity:0.6; } }
    .progress-pulse { animation: pulse 1.5s ease-in-out infinite; }

    /* Chip */
    .chip { display: inline-flex; align-items: center; gap: 4px; padding: 3px 10px; border-radius: 9999px; font-size: 12px; font-weight: 500; }
    .chip-remove { cursor: pointer; opacity: 0.5; transition: opacity 0.15s; }
    .chip-remove:hover { opacity: 1; }

    /* Radio card */
    .radio-card { border: 2px solid #e7e5e4; border-radius: 0.75rem; padding: 0.75rem; cursor: pointer; transition: all 0.15s; }
    .radio-card:hover { border-color: #a8a29e; }
    .radio-card.selected { border-color: #1e3a5f; background: rgba(30,58,95,0.03); }

    /* Copied flash */
    @keyframes copiedFlash { 0% { opacity:0; transform:translateY(4px); } 20% { opacity:1; transform:translateY(0); } 80% { opacity:1; } 100% { opacity:0; transform:translateY(-4px); } }
    .copied-flash { animation: copiedFlash 1.5s ease-out forwards; }

    /* Toast */
    @keyframes toastIn { from { opacity:0; transform: translateY(-12px); } to { opacity:1; transform: translateY(0); } }
    .toast-enter { animation: toastIn 0.3s ease-out; }

    /* Tooltip */
    .tooltip-wrapper { position: relative; }
    .tooltip-wrapper .tooltip-text {
      visibility:hidden; opacity:0; position:absolute; bottom:calc(100% + 6px); left:50%;
      transform:translateX(-50%); background:#1e293b; color:white; padding:4px 10px;
      border-radius:6px; font-size:11px; white-space:nowrap; transition:opacity 0.2s; z-index:50;
    }
    .tooltip-wrapper:hover .tooltip-text { visibility:visible; opacity:1; }

    /* ===== MOBILE MODE OVERRIDES ===== */
    .mobile-mode .page-pad { padding-left: 0.75rem !important; padding-right: 0.75rem !important; }
    .mobile-mode .cards-grid { grid-template-columns: 1fr !important; }
    .mobile-mode .section-card { padding: 0.75rem !important; }
    .mobile-mode .header-row { flex-direction: column; gap: 0.5rem; }
    .mobile-mode .header-icon { display: none !important; }
    .mobile-mode .header-actions { width: 100%; justify-content: flex-end; }
    .mobile-mode .header-subtitle .desktop-only { display: none !important; }
    .mobile-mode .options-grid { grid-template-columns: 1fr !important; }
    .mobile-mode .expiry-grid { grid-template-columns: repeat(2, 1fr) !important; }
    .mobile-mode .pdf-preview { display: none !important; }
    .mobile-mode .email-fields-grid { grid-template-columns: 1fr !important; }
  </style>
</head>
<body class="bg-stone-200 min-h-screen">

  <!-- VIEWPORT SWITCHER -->
  <div class="fixed top-0 left-0 right-0 bg-stone-800 text-white z-[100] shadow-lg">
    <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <span class="text-sm font-bold font-outfit">MAQUETTE 10</span>
        <span class="text-xs text-stone-400">Exporter & Partager</span>
      </div>
      <div class="flex items-center gap-2">
        <button onclick="setViewport('mobile')" id="btn-mobile" class="viewport-btn px-3 py-1.5 rounded-lg text-xs font-medium bg-stone-700 hover:bg-stone-600 transition-colors">Mobile (375px)</button>
        <button onclick="setViewport('tablet')" id="btn-tablet" class="viewport-btn px-3 py-1.5 rounded-lg text-xs font-medium bg-stone-700 hover:bg-stone-600 transition-colors">Tablette (768px)</button>
        <button onclick="setViewport('desktop')" id="btn-desktop" class="viewport-btn active px-3 py-1.5 rounded-lg text-xs font-medium bg-stone-700 hover:bg-stone-600 transition-colors">Desktop (1280px)</button>
      </div>
      <div class="text-xs text-stone-400">Page export / partage</div>
    </div>
  </div>

  <!-- STATE SWITCHER -->
  <div class="fixed top-[52px] left-0 right-0 bg-stone-700 text-white z-[99] border-t border-stone-600">
    <div class="max-w-7xl mx-auto px-4 py-2 flex items-center gap-2 flex-wrap">
      <span class="text-xs text-stone-400 font-medium">ETAT :</span>
      <button onclick="showState('normal')" id="state-normal" class="state-btn active px-2.5 py-1 rounded-md text-xs font-medium bg-stone-600 hover:bg-stone-500 transition-colors">A — Normal</button>
      <button onclick="showState('generating')" id="state-generating" class="state-btn px-2.5 py-1 rounded-md text-xs font-medium bg-stone-600 hover:bg-stone-500 transition-colors">B — Génération PDF</button>
      <button onclick="showState('pdf-ready')" id="state-pdf-ready" class="state-btn px-2.5 py-1 rounded-md text-xs font-medium bg-stone-600 hover:bg-stone-500 transition-colors">C — PDF prêt</button>
      <button onclick="showState('link-created')" id="state-link-created" class="state-btn px-2.5 py-1 rounded-md text-xs font-medium bg-stone-600 hover:bg-stone-500 transition-colors">D — Lien créé</button>
      <button onclick="showState('email-sent')" id="state-email-sent" class="state-btn px-2.5 py-1 rounded-md text-xs font-medium bg-stone-600 hover:bg-stone-500 transition-colors">E — Email envoyé</button>
      <button onclick="showState('errors')" id="state-errors" class="state-btn px-2.5 py-1 rounded-md text-xs font-medium bg-stone-600 hover:bg-stone-500 transition-colors">F — Erreurs</button>
    </div>
  </div>

  <!-- ============================================== -->
  <!-- STATE A — Normal (options prêtes)               -->
  <!-- ============================================== -->
  <div id="state-normal-section" class="state-section active pt-28 pb-8 px-4">
    <div id="viewport-frame-a" class="viewport-frame viewport-frame-scrollable bg-white shadow-2xl rounded-xl border border-stone-300" style="width:100%; max-width:1280px; max-height:85vh;">
      <div class="bg-stone-50 min-h-[80vh]">

        <!-- Page header -->
        <div class="bg-white border-b border-stone-200 px-4 sm:px-6 lg:px-8 py-4 page-pad">
          <div class="max-w-5xl mx-auto">
            <div class="flex items-center gap-1.5 text-xs text-stone-400 mb-3 overflow-hidden">
              <span class="hover:text-stone-600 cursor-pointer flex-shrink-0">Transactions</span>
              <svg class="w-3 h-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
              <span class="hover:text-stone-600 cursor-pointer truncate">Marie-Claire Dupont</span>
              <svg class="w-3 h-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
              <span class="text-stone-600 font-medium flex-shrink-0">Exporter & Partager</span>
            </div>
            <div class="header-row flex items-start justify-between gap-2">
              <div class="flex items-center gap-3">
                <div class="header-icon w-9 h-9 rounded-lg bg-primary/10 flex items-center justify-center flex-shrink-0">
                  <svg class="w-4.5 h-4.5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"/></svg>
                </div>
                <div class="min-w-0">
                  <h1 class="text-base sm:text-lg font-bold text-stone-900 font-outfit">Exporter & Partager</h1>
                  <div class="header-subtitle flex flex-wrap items-center gap-x-2 gap-y-0.5 mt-0.5">
                    <span class="text-xs text-stone-500 truncate">Marie-Claire Dupont</span>
                    <span class="desktop-only text-stone-300">·</span>
                    <span class="desktop-only text-xs text-stone-500 truncate">125 rue Principale, Moncton</span>
                  </div>
                </div>
              </div>
              <button class="px-3 py-2 text-xs font-medium text-stone-600 bg-white border border-stone-300 rounded-lg hover:bg-stone-50 flex-shrink-0">Retour</button>
            </div>
          </div>
        </div>

        <!-- 3 cards -->
        <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-6 page-pad">
          <div class="cards-grid grid grid-cols-1 lg:grid-cols-3 gap-5">

            <!-- CARD 1: Exporter PDF -->
            <div class="bg-white rounded-xl border border-stone-200 shadow-sm flex flex-col">
              <div class="px-5 pt-5 pb-3 border-b border-stone-100">
                <div class="flex items-center gap-2.5">
                  <div class="w-8 h-8 rounded-lg bg-red-50 flex items-center justify-center">
                    <svg class="w-4 h-4 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"/></svg>
                  </div>
                  <div>
                    <h3 class="text-sm font-semibold text-stone-900 font-outfit">Exporter PDF</h3>
                    <p class="text-[10px] text-stone-400">Récap complet de la transaction</p>
                  </div>
                </div>
              </div>
              <div class="px-5 py-4 flex-1 space-y-3">
                <!-- Options checkboxes -->
                <div>
                  <p class="text-[10px] font-semibold text-stone-500 uppercase tracking-wide mb-2">Inclure</p>
                  <div class="space-y-2">
                    <label class="flex items-center gap-2 cursor-pointer">
                      <input type="checkbox" checked class="rounded border-stone-300 text-primary focus:ring-primary/30">
                      <span class="text-xs text-stone-700">Détails de l'offre acceptée</span>
                    </label>
                    <label class="flex items-center gap-2 cursor-pointer">
                      <input type="checkbox" checked class="rounded border-stone-300 text-primary focus:ring-primary/30">
                      <span class="text-xs text-stone-700">Conditions ({N} actives)</span>
                    </label>
                    <label class="flex items-center gap-2 cursor-pointer">
                      <input type="checkbox" class="rounded border-stone-300 text-primary focus:ring-primary/30">
                      <span class="text-xs text-stone-700">Documents ({N} fichiers)</span>
                    </label>
                    <label class="flex items-center gap-2 cursor-pointer">
                      <input type="checkbox" class="rounded border-stone-300 text-primary focus:ring-primary/30">
                      <span class="text-xs text-stone-700">Historique d'activité</span>
                    </label>
                  </div>
                </div>

                <!-- Watermark -->
                <div class="flex items-center justify-between py-2 border-t border-stone-100">
                  <span class="text-xs text-stone-700">Filigrane «&nbsp;Confidentiel&nbsp;»</span>
                  <div class="toggle-track on" onclick="this.classList.toggle('on')">
                    <div class="toggle-dot"></div>
                  </div>
                </div>

                <!-- Langue -->
                <div>
                  <label class="block text-[10px] font-semibold text-stone-500 uppercase tracking-wide mb-1">Langue</label>
                  <select class="w-full px-3 py-1.5 text-xs border border-stone-300 rounded-lg outline-none bg-white">
                    <option selected>Français</option>
                    <option>English</option>
                  </select>
                </div>

                <!-- Preview mini -->
                <div class="pdf-preview rounded-lg border border-stone-200 bg-stone-50 p-3 text-center">
                  <div class="w-16 h-20 bg-white border border-stone-200 rounded shadow-sm mx-auto mb-1.5 flex items-center justify-center">
                    <svg class="w-6 h-6 text-stone-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"/></svg>
                  </div>
                  <p class="text-[10px] text-stone-400">Aperçu ~{N} pages</p>
                </div>
              </div>
              <div class="px-5 pb-5">
                <button class="w-full px-4 py-2.5 text-xs font-medium text-white bg-primary hover:bg-primary/90 rounded-lg shadow-sm flex items-center justify-center gap-1.5">
                  <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
                  Générer PDF
                </button>
              </div>
            </div>

            <!-- CARD 2: Lien partageable -->
            <div class="bg-white rounded-xl border border-stone-200 shadow-sm flex flex-col">
              <div class="px-5 pt-5 pb-3 border-b border-stone-100">
                <div class="flex items-center gap-2.5">
                  <div class="w-8 h-8 rounded-lg bg-blue-50 flex items-center justify-center">
                    <svg class="w-4 h-4 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/></svg>
                  </div>
                  <div>
                    <h3 class="text-sm font-semibold text-stone-900 font-outfit">Lien partageable</h3>
                    <p class="text-[10px] text-stone-400">Accès web sans compte requis</p>
                  </div>
                </div>
              </div>
              <div class="px-5 py-4 flex-1 space-y-3">
                <!-- Toggle actif -->
                <div class="flex items-center justify-between">
                  <span class="text-xs font-medium text-stone-700">Lien actif</span>
                  <div id="link-toggle" class="toggle-track" onclick="toggleLink(this)">
                    <div class="toggle-dot"></div>
                  </div>
                </div>

                <!-- Rôle -->
                <div id="link-options" class="space-y-3 opacity-40 pointer-events-none">
                  <div>
                    <p class="text-[10px] font-semibold text-stone-500 uppercase tracking-wide mb-2">Rôle du lien</p>
                    <div class="options-grid grid grid-cols-2 gap-2">
                      <div class="radio-card selected text-center" onclick="selectRole(this)">
                        <svg class="w-4 h-4 text-primary mx-auto mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
                        <p class="text-[11px] font-medium text-stone-700">Lecture seule</p>
                      </div>
                      <div class="radio-card text-center" onclick="selectRole(this)">
                        <svg class="w-4 h-4 text-stone-400 mx-auto mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"/></svg>
                        <p class="text-[11px] font-medium text-stone-700">Commentaire</p>
                      </div>
                    </div>
                  </div>

                  <!-- Expiration -->
                  <div>
                    <p class="text-[10px] font-semibold text-stone-500 uppercase tracking-wide mb-2">Expiration</p>
                    <div class="expiry-grid grid grid-cols-4 gap-1.5">
                      <button class="px-2 py-1.5 text-[10px] font-medium rounded-lg border border-stone-200 hover:border-primary hover:text-primary text-stone-600">24h</button>
                      <button class="px-2 py-1.5 text-[10px] font-medium rounded-lg border-2 border-primary text-primary bg-primary/5">7 jours</button>
                      <button class="px-2 py-1.5 text-[10px] font-medium rounded-lg border border-stone-200 hover:border-primary hover:text-primary text-stone-600">30 jours</button>
                      <button class="px-2 py-1.5 text-[10px] font-medium rounded-lg border border-stone-200 hover:border-primary hover:text-primary text-stone-600">Custom</button>
                    </div>
                  </div>

                  <!-- Mot de passe -->
                  <div>
                    <div class="flex items-center justify-between mb-1">
                      <span class="text-[10px] font-semibold text-stone-500 uppercase tracking-wide">Mot de passe</span>
                      <span class="text-[10px] text-stone-400">optionnel</span>
                    </div>
                    <input type="password" placeholder="••••••••" class="w-full px-3 py-1.5 text-xs border border-stone-300 rounded-lg outline-none placeholder:text-stone-300">
                  </div>
                </div>
              </div>
              <div class="px-5 pb-5">
                <button id="create-link-btn" class="w-full px-4 py-2.5 text-xs font-medium text-white rounded-lg shadow-sm bg-stone-300 cursor-not-allowed flex items-center justify-center gap-1.5" disabled>
                  <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/></svg>
                  Créer le lien
                </button>
              </div>
            </div>

            <!-- CARD 3: Email récap -->
            <div class="bg-white rounded-xl border border-stone-200 shadow-sm flex flex-col">
              <div class="px-5 pt-5 pb-3 border-b border-stone-100">
                <div class="flex items-center gap-2.5">
                  <div class="w-8 h-8 rounded-lg bg-emerald-50 flex items-center justify-center">
                    <svg class="w-4 h-4 text-emerald-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
                  </div>
                  <div>
                    <h3 class="text-sm font-semibold text-stone-900 font-outfit">Email récap</h3>
                    <p class="text-[10px] text-stone-400">Envoyer un résumé par courriel</p>
                  </div>
                </div>
              </div>
              <div class="px-5 py-4 flex-1 space-y-3">
                <!-- Destinataires -->
                <div>
                  <p class="text-[10px] font-semibold text-stone-500 uppercase tracking-wide mb-2">Destinataires</p>
                  <div class="border border-stone-300 rounded-lg p-2 min-h-[60px]">
                    <div class="flex flex-wrap gap-1.5 mb-1.5">
                      <span class="chip bg-primary/10 text-primary">
                        mc.dupont@email.com
                        <svg class="w-3 h-3 chip-remove" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                      </span>
                      <span class="chip bg-primary/10 text-primary">
                        s.leblanc@cabinet.ca
                        <svg class="w-3 h-3 chip-remove" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                      </span>
                    </div>
                    <input type="email" placeholder="Ajouter un courriel..." class="w-full text-xs outline-none placeholder:text-stone-300 py-0.5" id="email-input" onkeydown="if(event.key==='Enter'){addEmailChip(this)}">
                  </div>
                  <p class="text-[10px] text-stone-400 mt-1">{N} destinataire(s) · Appuyez Entrée pour ajouter</p>
                </div>

                <!-- Objet -->
                <div>
                  <label class="block text-[10px] font-semibold text-stone-500 uppercase tracking-wide mb-1">Objet</label>
                  <input type="text" value="Récap transaction — 125 rue Principale, Moncton" class="w-full px-3 py-1.5 text-xs border border-stone-300 rounded-lg outline-none">
                </div>

                <!-- Message -->
                <div>
                  <label class="block text-[10px] font-semibold text-stone-500 uppercase tracking-wide mb-1">Message</label>
                  <textarea rows="3" class="w-full px-3 py-1.5 text-xs border border-stone-300 rounded-lg outline-none resize-none" placeholder="Message personnalisé (optionnel)...">Bonjour, voici le récapitulatif de la transaction en cours.</textarea>
                </div>

                <!-- Template preview link -->
                <button class="text-xs text-primary font-medium hover:underline flex items-center gap-1">
                  <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
                  Prévisualiser l'email
                </button>
              </div>
              <div class="px-5 pb-5">
                <button class="w-full px-4 py-2.5 text-xs font-medium text-white bg-emerald-600 hover:bg-emerald-700 rounded-lg shadow-sm flex items-center justify-center gap-1.5">
                  <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/></svg>
                  Envoyer le récap
                </button>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ============================================== -->
  <!-- STATE B — Génération PDF en cours               -->
  <!-- ============================================== -->
  <div id="state-generating-section" class="state-section pt-28 pb-8 px-4">
    <div id="viewport-frame-b" class="viewport-frame bg-stone-100 shadow-2xl rounded-xl border border-stone-300 relative" style="width:100%; max-width:1280px; height:80vh;">
      <div class="overlay absolute inset-0 flex items-center justify-center p-4 z-10">
        <div class="modal-enter bg-white rounded-2xl shadow-2xl w-full max-w-sm">
          <div class="mobile-handle hidden justify-center pt-3 pb-1"><div class="w-8 h-1 rounded-full bg-stone-300"></div></div>
          <div class="p-6 text-center">
            <div class="w-14 h-14 rounded-full bg-primary/10 flex items-center justify-center mx-auto mb-4 progress-pulse">
              <svg class="w-7 h-7 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"/></svg>
            </div>
            <h3 class="text-sm font-bold text-stone-900 font-outfit mb-1">Génération du PDF en cours</h3>
            <p class="text-xs text-stone-500 mb-4">Compilation des données de la transaction...</p>

            <!-- Progress bar -->
            <div class="w-full bg-stone-200 rounded-full h-2 mb-2">
              <div class="progress-fill bg-primary h-2 rounded-full" style="width: 65%;"></div>
            </div>
            <p class="text-[10px] text-stone-400 mb-4">65% — Génération des conditions...</p>

            <button class="px-4 py-2 text-xs font-medium text-stone-500 bg-white border border-stone-300 rounded-lg hover:bg-stone-50">
              Annuler
            </button>
          </div>
        </div>
      </div>
      <div class="absolute inset-0 bg-stone-50 opacity-50 p-8">
        <div class="max-w-4xl mx-auto"><div class="h-6 bg-stone-200 rounded w-48 mb-4"></div><div class="h-32 bg-stone-200 rounded w-full mb-3"></div><div class="h-32 bg-stone-200 rounded w-full"></div></div>
      </div>
    </div>
  </div>

  <!-- ============================================== -->
  <!-- STATE C — PDF prêt                              -->
  <!-- ============================================== -->
  <div id="state-pdf-ready-section" class="state-section pt-28 pb-8 px-4">
    <div id="viewport-frame-c" class="viewport-frame bg-stone-100 shadow-2xl rounded-xl border border-stone-300 relative" style="width:100%; max-width:1280px; height:80vh;">
      <div class="overlay absolute inset-0 flex items-center justify-center p-4 z-10">
        <div class="modal-enter bg-white rounded-2xl shadow-2xl w-full max-w-sm">
          <div class="mobile-handle hidden justify-center pt-3 pb-1"><div class="w-8 h-1 rounded-full bg-stone-300"></div></div>
          <div class="p-6 text-center">
            <div class="w-14 h-14 rounded-full bg-emerald-100 flex items-center justify-center mx-auto mb-4">
              <svg class="w-7 h-7 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
            </div>
            <h3 class="text-sm font-bold text-stone-900 font-outfit mb-1">PDF généré avec succès</h3>
            <p class="text-xs text-stone-500 mb-4">Transaction_Dupont_2025-03.pdf — {N} pages, {N} Ko</p>

            <!-- File preview -->
            <div class="rounded-lg border border-stone-200 bg-stone-50 p-3 mb-4 flex items-center gap-3">
              <div class="w-10 h-12 bg-red-50 border border-red-200 rounded flex items-center justify-center flex-shrink-0">
                <svg class="w-5 h-5 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"/></svg>
              </div>
              <div class="text-left min-w-0">
                <p class="text-xs font-medium text-stone-700 truncate">Transaction_Dupont_2025-03.pdf</p>
                <p class="text-[10px] text-stone-400">{N} pages · Français · Filigrane actif</p>
              </div>
            </div>

            <div class="space-y-2">
              <button class="w-full px-4 py-2.5 text-xs font-medium text-white bg-primary hover:bg-primary/90 rounded-lg shadow-sm flex items-center justify-center gap-1.5">
                <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/></svg>
                Télécharger
              </button>
              <button class="w-full px-4 py-2 text-xs font-medium text-primary bg-white border border-stone-300 rounded-lg hover:bg-stone-50 flex items-center justify-center gap-1.5">
                <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/></svg>
                Ouvrir dans un nouvel onglet
              </button>
            </div>
          </div>
        </div>
      </div>
      <div class="absolute inset-0 bg-stone-50 opacity-50 p-8">
        <div class="max-w-4xl mx-auto"><div class="h-6 bg-stone-200 rounded w-48 mb-4"></div><div class="h-32 bg-stone-200 rounded w-full mb-3"></div><div class="h-32 bg-stone-200 rounded w-full"></div></div>
      </div>
    </div>
  </div>

  <!-- ============================================== -->
  <!-- STATE D — Lien créé                             -->
  <!-- ============================================== -->
  <div id="state-link-created-section" class="state-section pt-28 pb-8 px-4">
    <div id="viewport-frame-d" class="viewport-frame bg-stone-100 shadow-2xl rounded-xl border border-stone-300 relative" style="width:100%; max-width:1280px; height:80vh;">
      <div class="overlay absolute inset-0 flex items-center justify-center p-4 z-10">
        <div class="modal-enter bg-white rounded-2xl shadow-2xl w-full max-w-md">
          <div class="mobile-handle hidden justify-center pt-3 pb-1"><div class="w-8 h-1 rounded-full bg-stone-300"></div></div>
          <div class="p-6">
            <div class="flex items-center gap-3 mb-4">
              <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center">
                <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/></svg>
              </div>
              <div>
                <h3 class="text-sm font-bold text-stone-900 font-outfit">Lien partageable créé</h3>
                <p class="text-xs text-stone-500">Expire dans 7 jours</p>
              </div>
            </div>

            <!-- URL field -->
            <div class="flex items-center gap-2 bg-stone-50 border border-stone-200 rounded-lg p-2 mb-3">
              <input type="text" value="https://app.ofra.ca/share/txn-abc123-xyz" readonly class="flex-1 text-xs text-stone-600 bg-transparent outline-none truncate" id="share-url">
              <button onclick="copyLink()" id="copy-btn" class="px-3 py-1.5 text-[10px] font-medium text-white bg-primary hover:bg-primary/90 rounded-md flex items-center gap-1 flex-shrink-0">
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"/></svg>
                Copier
              </button>
            </div>

            <!-- Link info -->
            <div class="rounded-lg border border-stone-200 divide-y divide-stone-100 mb-4">
              <div class="px-3 py-2 flex items-center justify-between">
                <span class="text-xs text-stone-500">Rôle</span>
                <span class="text-xs font-medium text-stone-700">Lecture seule</span>
              </div>
              <div class="px-3 py-2 flex items-center justify-between">
                <span class="text-xs text-stone-500">Expiration</span>
                <span class="text-xs font-medium text-stone-700">7 jours (17 fév. 2026)</span>
              </div>
              <div class="px-3 py-2 flex items-center justify-between">
                <span class="text-xs text-stone-500">Mot de passe</span>
                <span class="text-xs font-medium text-stone-500">Aucun</span>
              </div>
              <div class="px-3 py-2 flex items-center justify-between">
                <span class="text-xs text-stone-500">Visites</span>
                <span class="text-xs font-medium text-stone-700">0</span>
              </div>
            </div>

            <div class="flex items-center gap-2">
              <button class="flex-1 px-3 py-2 text-xs font-medium text-stone-600 bg-white border border-stone-300 rounded-lg hover:bg-stone-50">Fermer</button>
              <button class="px-3 py-2 text-xs font-medium text-red-600 bg-white border border-red-200 rounded-lg hover:bg-red-50">Révoquer le lien</button>
            </div>
          </div>
        </div>
      </div>
      <div class="absolute inset-0 bg-stone-50 opacity-50 p-8">
        <div class="max-w-4xl mx-auto"><div class="h-6 bg-stone-200 rounded w-48 mb-4"></div><div class="h-32 bg-stone-200 rounded w-full mb-3"></div><div class="h-32 bg-stone-200 rounded w-full"></div></div>
      </div>
    </div>
  </div>

  <!-- ============================================== -->
  <!-- STATE E — Email envoyé                          -->
  <!-- ============================================== -->
  <div id="state-email-sent-section" class="state-section pt-28 pb-8 px-4">
    <div id="viewport-frame-e" class="viewport-frame bg-stone-100 shadow-2xl rounded-xl border border-stone-300 relative" style="width:100%; max-width:1280px; height:80vh;">
      <div class="overlay absolute inset-0 flex items-center justify-center p-4 z-10">
        <div class="modal-enter bg-white rounded-2xl shadow-2xl w-full max-w-sm">
          <div class="mobile-handle hidden justify-center pt-3 pb-1"><div class="w-8 h-1 rounded-full bg-stone-300"></div></div>
          <div class="p-6 text-center">
            <div class="w-14 h-14 rounded-full bg-emerald-100 flex items-center justify-center mx-auto mb-4">
              <svg class="w-7 h-7 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
            </div>
            <h3 class="text-sm font-bold text-stone-900 font-outfit mb-1">Récap envoyé avec succès</h3>
            <p class="text-xs text-stone-500 mb-4">Le résumé de la transaction a été envoyé</p>

            <!-- Recipients -->
            <div class="rounded-lg bg-stone-50 border border-stone-200 p-3 text-left mb-4">
              <p class="text-[10px] font-semibold text-stone-500 uppercase tracking-wide mb-2">Destinataires ({N})</p>
              <div class="space-y-1.5">
                <div class="flex items-center gap-2 text-xs">
                  <svg class="w-3.5 h-3.5 text-emerald-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                  <span class="text-stone-600">mc.dupont@email.com</span>
                </div>
                <div class="flex items-center gap-2 text-xs">
                  <svg class="w-3.5 h-3.5 text-emerald-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                  <span class="text-stone-600">s.leblanc@cabinet.ca</span>
                </div>
              </div>
            </div>

            <div class="rounded-lg bg-blue-50 border border-blue-200 p-2.5 text-left mb-4">
              <p class="text-[10px] text-blue-600 flex items-start gap-1.5">
                <svg class="w-3.5 h-3.5 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                Objet : Récap transaction — 125 rue Principale, Moncton
              </p>
            </div>

            <button class="w-full px-4 py-2.5 text-xs font-medium text-primary bg-white border border-stone-300 rounded-lg hover:bg-stone-50">
              Fermer
            </button>
          </div>
        </div>
      </div>
      <div class="absolute inset-0 bg-stone-50 opacity-50 p-8">
        <div class="max-w-4xl mx-auto"><div class="h-6 bg-stone-200 rounded w-48 mb-4"></div><div class="h-32 bg-stone-200 rounded w-full mb-3"></div><div class="h-32 bg-stone-200 rounded w-full"></div></div>
      </div>
    </div>
  </div>

  <!-- ============================================== -->
  <!-- STATE F — Erreurs                               -->
  <!-- ============================================== -->
  <div id="state-errors-section" class="state-section pt-28 pb-8 px-4">
    <div id="viewport-frame-f" class="viewport-frame viewport-frame-scrollable bg-white shadow-2xl rounded-xl border border-stone-300" style="width:100%; max-width:1280px; max-height:85vh;">
      <div class="bg-stone-50 min-h-[80vh]">

        <!-- Page header (same as A) -->
        <div class="bg-white border-b border-stone-200 px-4 sm:px-6 lg:px-8 py-4 page-pad">
          <div class="max-w-5xl mx-auto">
            <div class="flex items-center gap-1.5 text-xs text-stone-400 mb-3 overflow-hidden">
              <span class="flex-shrink-0">Transactions</span>
              <svg class="w-3 h-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
              <span class="truncate">Marie-Claire Dupont</span>
              <svg class="w-3 h-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
              <span class="text-stone-600 font-medium flex-shrink-0">Exporter & Partager</span>
            </div>
            <h1 class="text-base sm:text-lg font-bold text-stone-900 font-outfit">Exporter & Partager</h1>
          </div>
        </div>

        <!-- Error cards -->
        <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-6 page-pad">
          <div class="space-y-4">

            <!-- Error 1: PDF generation failed -->
            <div class="bg-white rounded-xl border border-red-200 p-5 section-card">
              <div class="flex items-start gap-3">
                <div class="w-9 h-9 rounded-lg bg-red-50 flex items-center justify-center flex-shrink-0">
                  <svg class="w-4.5 h-4.5 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"/></svg>
                </div>
                <div class="flex-1 min-w-0">
                  <h3 class="text-sm font-semibold text-red-800 font-outfit">Échec de génération PDF</h3>
                  <p class="text-xs text-red-600 mt-0.5">La transaction contient trop de documents ({N} fichiers, {N} Mo). Limite dépassée pour votre plan.</p>
                  <div class="flex items-center gap-2 mt-3">
                    <button class="px-3 py-1.5 text-xs font-medium text-white bg-primary hover:bg-primary/90 rounded-lg">Réessayer sans documents</button>
                    <button class="px-3 py-1.5 text-xs font-medium text-primary bg-white border border-stone-300 rounded-lg hover:bg-stone-50">Mettre à niveau</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Error 2: Invalid email -->
            <div class="bg-white rounded-xl border border-red-200 p-5 section-card">
              <div class="flex items-start gap-3">
                <div class="w-9 h-9 rounded-lg bg-red-50 flex items-center justify-center flex-shrink-0">
                  <svg class="w-4.5 h-4.5 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
                </div>
                <div class="flex-1 min-w-0">
                  <h3 class="text-sm font-semibold text-red-800 font-outfit">Erreur d'envoi email</h3>
                  <p class="text-xs text-red-600 mt-0.5">L'adresse <strong>invalid@.com</strong> n'est pas un courriel valide.</p>
                  <div class="flex items-center gap-2 mt-3">
                    <button class="px-3 py-1.5 text-xs font-medium text-white bg-primary hover:bg-primary/90 rounded-lg">Corriger l'adresse</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Error 3: Permission denied -->
            <div class="bg-white rounded-xl border border-amber-200 p-5 section-card">
              <div class="flex items-start gap-3">
                <div class="w-9 h-9 rounded-lg bg-amber-50 flex items-center justify-center flex-shrink-0">
                  <svg class="w-4.5 h-4.5 text-amber-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/></svg>
                </div>
                <div class="flex-1 min-w-0">
                  <h3 class="text-sm font-semibold text-amber-800 font-outfit">Permission refusée — Lien partageable</h3>
                  <p class="text-xs text-amber-600 mt-0.5">Votre plan <strong>Starter</strong> ne permet pas de créer des liens partageables. Cette fonctionnalité est disponible à partir du plan <strong>Solo</strong>.</p>
                  <div class="flex items-center gap-2 mt-3">
                    <button class="px-3 py-1.5 text-xs font-medium text-white bg-accent hover:bg-accent/90 rounded-lg">Voir les plans</button>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>


  <!-- ============================================== -->
  <!-- JAVASCRIPT                                      -->
  <!-- ============================================== -->
  <script>
    /* ---- Viewport Switcher ---- */
    const vpSizes = { mobile: 375, tablet: 768, desktop: 1280 };
    function setViewport(size) {
      document.querySelectorAll('.viewport-btn').forEach(b => b.classList.remove('active'));
      document.getElementById('btn-' + size).classList.add('active');
      const w = vpSizes[size];
      document.querySelectorAll('.viewport-frame').forEach(f => {
        f.style.maxWidth = w + 'px';
        if (size === 'mobile') f.classList.add('mobile-mode');
        else f.classList.remove('mobile-mode');
      });
    }

    /* ---- State Switcher ---- */
    function showState(state) {
      document.querySelectorAll('.state-section').forEach(s => s.classList.remove('active'));
      document.querySelectorAll('.state-btn').forEach(b => b.classList.remove('active'));
      const section = document.getElementById('state-' + state + '-section');
      const btn = document.getElementById('state-' + state);
      if (section) section.classList.add('active');
      if (btn) btn.classList.add('active');
    }

    /* ---- Link Toggle ---- */
    function toggleLink(el) {
      el.classList.toggle('on');
      const opts = document.getElementById('link-options');
      const btn = document.getElementById('create-link-btn');
      if (el.classList.contains('on')) {
        opts.classList.remove('opacity-40', 'pointer-events-none');
        btn.disabled = false;
        btn.className = 'w-full px-4 py-2.5 text-xs font-medium text-white rounded-lg shadow-sm bg-blue-600 hover:bg-blue-700 cursor-pointer flex items-center justify-center gap-1.5';
      } else {
        opts.classList.add('opacity-40', 'pointer-events-none');
        btn.disabled = true;
        btn.className = 'w-full px-4 py-2.5 text-xs font-medium text-white rounded-lg shadow-sm bg-stone-300 cursor-not-allowed flex items-center justify-center gap-1.5';
      }
    }

    /* ---- Role Selection ---- */
    function selectRole(el) {
      el.parentElement.querySelectorAll('.radio-card').forEach(c => c.classList.remove('selected'));
      el.classList.add('selected');
    }

    /* ---- Copy Link ---- */
    function copyLink() {
      const url = document.getElementById('share-url');
      const btn = document.getElementById('copy-btn');
      if (url) {
        url.select();
        // Simulate copy
        const original = btn.innerHTML;
        btn.innerHTML = '<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg> Copié !';
        btn.classList.remove('bg-primary', 'hover:bg-primary/90');
        btn.classList.add('bg-emerald-600');
        setTimeout(() => {
          btn.innerHTML = original;
          btn.classList.add('bg-primary', 'hover:bg-primary/90');
          btn.classList.remove('bg-emerald-600');
        }, 2000);
      }
    }

    /* ---- Add Email Chip (simulate) ---- */
    function addEmailChip(input) {
      const val = input.value.trim();
      if (!val) return;
      const container = input.parentElement.querySelector('.flex.flex-wrap');
      if (!container) return;
      const chip = document.createElement('span');
      chip.className = 'chip bg-primary/10 text-primary';
      chip.innerHTML = val + ' <svg class="w-3 h-3 chip-remove" onclick="this.parentElement.remove()" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>';
      container.appendChild(chip);
      input.value = '';
    }

    /* ---- Init ---- */
    setViewport('desktop');
    showState('normal');
  </script>

</body>
</html>
